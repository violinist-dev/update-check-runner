language: php
dist: xenial
php:
- '7.0'
- '7.1'
- '7.2'
- '7.3'
- '7.4'
env:
  - COMPOSER_VERSION_SUFFIX=1
  - COMPOSER_VERSION_SUFFIX=2
services:
- docker
script:
- export MY_COMMIT=$(git log --format=format:%H -n1)
- composer install
- if [ $(phpenv version-name) = "7.0" ]; then docker build --build-arg COMPOSER_VERSION=${COMPOSER_VERSION_SUFFIX} -t update-check-runner . -f Dockerfile-70${COMPOSER_VERSION_SUFFIX}; fi
- if [ $(phpenv version-name) = "7.1" ]; then docker build -t update-check-runner . -f Dockerfile-71; fi
- if [ $(phpenv version-name) = "7.2" ]; then docker build -t update-check-runner . -f Dockerfile-72; fi
- if [ $(phpenv version-name) = "7.3" ]; then docker build -t update-check-runner . -f Dockerfile-73; fi
- if [ $(phpenv version-name) = "7.4" ]; then docker build -t update-check-runner . -f Dockerfile-74; fi
- "./vendor/bin/phpunit"
